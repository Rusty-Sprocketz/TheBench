# v2.9.3 â€” App Self-Destruct Fix

## Bug Fix

Apps were persisting well beyond the 30-minute TTL because cleanup only fired on the next pipeline launch (preflight) or once daily via cron at midnight UTC. A visitor reported their app was still live over an hour after creation.

## Changes

### `client/src/hooks/usePipeline.js`
- Added a `useEffect` that schedules `cleanupDeployment()` via `setTimeout` exactly when the 30-minute window expires after `deployedAt`.
- Handles both fresh deployments and restored localStorage sessions: if `deployedAt` is already partially elapsed, the remaining time is calculated and the timer fires at the correct wall-clock moment. If already expired on restore, cleanup is called immediately.

### `vercel.json`
- Changed cron schedule from `0 0 * * *` (daily at midnight UTC) to `*/5 * * * *` (every 5 minutes).
- Server-side cleanup now catches orphaned projects (closed browser tabs, failed timers) within 5 minutes of expiry.

## How It Works Now

| Scenario | Before | After |
|---|---|---|
| Browser stays open | Cleanup on next launch or midnight | Cleanup exactly at 30-min mark |
| Browser closed mid-session | Cleanup on next launch or midnight | Cleanup within 5 min (cron) |
| Restored from localStorage | Cleanup on next launch or midnight | Immediate cleanup if expired; otherwise timer fires at correct time |
| No new launches for hours | App stays live indefinitely | Cron cleans up within 5 min |
