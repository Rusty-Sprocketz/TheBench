# v2.8.0 — Deterministic Functional Testing for Pipeline Demo Apps

## Summary
Adds two layers of deterministic testing to the pipeline to catch the most common demo app failure: mismatched field names between frontend, backend, and spec. Previously, testing relied entirely on LLM static analysis (Gemini reading the code), which missed these simple contract mismatches.

## Changes

### New: Pre-deploy Contract Validation (`runContractTests`)
- **Frontend→Spec request contract**: Verifies each `spec.apiContract.requestBody` field name appears in `app.js`
- **Backend→Spec response contract**: Verifies each `spec.apiContract.responseBody` field name appears in `api/generate.js`
- **Frontend→Spec response contract**: Verifies each `spec.apiContract.responseBody` field name is read in `app.js`
- **Fetch URL check**: Verifies `app.js` contains `/api/generate`
- **Error handling check**: Verifies `app.js` checks `response.ok` before parsing JSON
- Contract tests are appended to LLM test results with `category: "contract"` and included in failure details sent to the fixer

### Enhanced: Post-deploy Smoke Test
- **Response field validation**: Checks every expected response field exists and is non-empty (catches 200 OK + wrong field names)
- **HTML page load check**: Verifies `GET /` returns 200 (catches static file deployment failures)
- **Detailed failure reporting**: Includes failure reason, missing/empty fields, actual response fields — all fed to the fixer for targeted fixes

### Enhanced: Fixer Prompt
- Smoke test failures now include structured details (reason type, missing fields, actual fields) so the fixer can make targeted fixes instead of guessing

## Files Modified
- `api/pipeline.js` — Added `runContractTests()`, integrated into `handleTester`, enhanced smoke test in `handleDeployer`, improved fixer failure prompts
- `client/src/App.jsx` — Version bump
- `package.json` — Version bump
